<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="杂项收集"><meta name="keywords" content=""><meta name="author" content="Orches Adam"><meta name="copyright" content="Orches Adam"><title>杂项收集 | Orches's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Sql-Server-Analyze"><span class="toc-number">1.</span> <span class="toc-text">Sql Server Analyze</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#上传图片“加号按钮框”样式"><span class="toc-number">2.</span> <span class="toc-text">上传图片“加号按钮框”样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#将image转换成base64字符串"><span class="toc-number">3.</span> <span class="toc-text">将image转换成base64字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#net-framwork-引用-net-standrd-出现无法引用的问题"><span class="toc-number">4.</span> <span class="toc-text">net framwork 引用 net standrd 出现无法引用的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DbSet-Attach-entity-vs-DbContext-Entry-entity-State-EntityState-Modified"><span class="toc-number">5.</span> <span class="toc-text">DbSet.Attach(entity) vs DbContext.Entry(entity).State = EntityState.Modified</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Code-example"><span class="toc-number">5.1.</span> <span class="toc-text">Code example</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#当数据库存在时，使用entityframework-core-core-first"><span class="toc-number">6.</span> <span class="toc-text">当数据库存在时，使用entityframework core core first</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#更简单的办法"><span class="toc-number">7.</span> <span class="toc-text">更简单的办法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-复制一个对象"><span class="toc-number">8.</span> <span class="toc-text">C# 复制一个对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#在asp-net-core-mvc-中使用vue-js-SPA"><span class="toc-number">9.</span> <span class="toc-text">在asp.net core mvc 中使用vue.js SPA</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Orches Adam</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">4</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Orches's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">杂项收集</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-14</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h4 id="Sql-Server-Analyze"><a href="#Sql-Server-Analyze" class="headerlink" title="Sql Server Analyze"></a>Sql Server Analyze</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">set statistics profile on</span><br><span class="line">set statistics io on</span><br><span class="line">set statistics time on</span><br><span class="line">go</span><br><span class="line">&lt;input any code you want&gt;</span><br><span class="line">go</span><br><span class="line">set statistics profile off</span><br><span class="line">set statistics io off</span><br><span class="line">set statistics time off</span><br></pre></td></tr></table></figure>
<hr>
<a id="more"></a>
<h4 id="上传图片“加号按钮框”样式"><a href="#上传图片“加号按钮框”样式" class="headerlink" title="上传图片“加号按钮框”样式"></a>上传图片“加号按钮框”样式</h4><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;uploader-input-box&quot;&gt;</span><br><span class="line">  &lt;input id=&quot;uploaderInput&quot; class=&quot;uploader-input&quot; type=&quot;file&quot; accept=&quot;image/*&quot; multiple=&quot;&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"> .uploader__input-box &#123;</span><br><span class="line"> float: left;</span><br><span class="line"> position: relative;</span><br><span class="line"> margin-right: 9px;</span><br><span class="line"> margin-bottom: 9px;</span><br><span class="line"> width: 77px;</span><br><span class="line"> height: 77px;</span><br><span class="line"> border: 1px solid #d9d9d9;</span><br><span class="line"> &#125;</span><br><span class="line"> .uploader__input-box:after, .uploader__input-box:before &#123;</span><br><span class="line"> content: &quot; &quot;;</span><br><span class="line"> position: absolute;</span><br><span class="line"> top: 50%;</span><br><span class="line"> left: 50%;</span><br><span class="line"> -webkit-transform: translate(-50%,-50%);</span><br><span class="line"> transform: translate(-50%,-50%);</span><br><span class="line"> background-color: #d9d9d9;</span><br><span class="line"> &#125;</span><br><span class="line"> .uploader__input-box:before &#123;</span><br><span class="line"> width: 2px;</span><br><span class="line"> height: 39.5px;</span><br><span class="line"> &#125;</span><br><span class="line"> .uploader__input-box:after &#123;</span><br><span class="line"> width: 39.5px;</span><br><span class="line"> height: 2px;</span><br><span class="line"> &#125;</span><br><span class="line"> .uploader__input &#123;</span><br><span class="line"> position: absolute;</span><br><span class="line"> z-index: 1;</span><br><span class="line"> top: 0;</span><br><span class="line"> left: 0;</span><br><span class="line"> width: 100%;</span><br><span class="line"> height: 100%;</span><br><span class="line"> opacity: 0;</span><br><span class="line"> -webkit-tap-highlight-color: rgba(0,0,0,0);</span><br><span class="line"> &#125;</span><br><span class="line"> &lt;/style&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="将image转换成base64字符串"><a href="#将image转换成base64字符串" class="headerlink" title="将image转换成base64字符串"></a>将image转换成base64字符串</h4><p>see<br><a href="https://stackoverflow.com/questions/6150289/how-to-convert-image-into-base64-string-using-javascript" target="_blank" rel="noopener">url</a></p>
<hr>
<h4 id="net-framwork-引用-net-standrd-出现无法引用的问题"><a href="#net-framwork-引用-net-standrd-出现无法引用的问题" class="headerlink" title="net framwork 引用 net standrd 出现无法引用的问题"></a>net framwork 引用 net standrd 出现无法引用的问题</h4><p>see<br><a href="https://github.com/dotnet/sdk/issues/901" target="_blank" rel="noopener">url</a></p>
<hr>
<h4 id="DbSet-Attach-entity-vs-DbContext-Entry-entity-State-EntityState-Modified"><a href="#DbSet-Attach-entity-vs-DbContext-Entry-entity-State-EntityState-Modified" class="headerlink" title="DbSet.Attach(entity) vs DbContext.Entry(entity).State = EntityState.Modified"></a>DbSet.Attach(entity) vs DbContext.Entry(entity).State = EntityState.Modified</h4><p>&emsp;&emsp;When you do context.Entry(entity).State = EntityState.Modified;, you are not only attaching the entity to the DbContext, you are also marking the whole entity as dirty. This means that when you do context.SaveChanges(), EF will generate an update statement that will update all the fields of the entity.</p>

<p>&emsp;&emsp;This is not always desired.</p>

<p>&emsp;&emsp;On the other hand, DbSet.Attach(entity) attaches the entity to the context without marking it dirty. It is equivalent to doing context.Entry(entity).State = EntityState.Unchanged;</p>

<p>&emsp;&emsp;When attaching this way, unless you then proceed to update a property on the entity, the next time you call context.SaveChanges(), EF will not generate a database update for this entity.</p>

<p></p><p>&emsp;&emsp;Even if you are planning on making an update to an entity, if the entity has a lot of properties (db columns) but you only want to update a few, you may find it advantageous to do a DbSet.Attach(entity), and then only update the few properties that need updating. Doing it this way will generate a more efficient update statement from EF. EF will only update the properties you modified (in contrast to context.Entry(entity).State = EntityState.Modified; which will cause all properties/columns to be updated)</p>
<p>Relevant documentation: <a href="https://msdn.microsoft.com/en-us/data/jj592676" target="_blank" rel="noopener">Add/Attach and Entity States.</a></p>
<h5 id="Code-example"><a href="#Code-example" class="headerlink" title="Code example"></a>Code example</h5><p>Let’s say you have the following entity:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Person</span><br><span class="line">&#123;</span><br><span class="line">    public int Id &#123; get; set; &#125; // primary key</span><br><span class="line">    public string FirstName &#123; get; set; &#125;</span><br><span class="line">    public string LastName &#123; get; set; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>If your code looks like this:</p>
<p>context.Entry(personEntity).State = EntityState.Modified;<br>context.SaveChanges();<br>The SQL generated will look something like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE person</span><br><span class="line">SET FirstName = &apos;whatever first name is&apos;,</span><br><span class="line">    LastName = &apos;whatever last name is&apos;</span><br><span class="line">WHERE Id = 123; -- whatever Id is.</span><br></pre></td></tr></table></figure>
<p>Notice how the above update statement will update all the columns, regardless or whether you’ve actually changed the values or not.</p>
<p>In contrast, if your code uses the “normal” Attach like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">context.People.Attach(personEntity); // State = Unchanged</span><br><span class="line">personEntity.FirstName = &quot;John&quot;; // State = Modified, and only the FirstName property is dirty.</span><br><span class="line">context.SaveChanges();</span><br></pre></td></tr></table></figure></p>
<p>Then the generated update statement is different:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE person</span><br><span class="line">SET FirstName = &apos;John&apos;</span><br><span class="line">WHERE Id = 123; -- whatever Id is.</span><br></pre></td></tr></table></figure></p>
<p>As you can see, the update statement only updates the values that were actually changed after you attached the entity to the context. Depending on the structure of your table, this can have a positive performance impact.</p>
<p>Now, which option is better for you depends entirely on what you are trying to do.</p>
<hr>
<h4 id="当数据库存在时，使用entityframework-core-core-first"><a href="#当数据库存在时，使用entityframework-core-core-first" class="headerlink" title="当数据库存在时，使用entityframework core core first"></a>当数据库存在时，使用entityframework core core first</h4><blockquote>
<p>必要条件</p>
</blockquote>
<p> 通过Nuget安装<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.EntityFramework.Core</span><br><span class="line">Microsoft.EntityFramework.Tools</span><br><span class="line">Microsoft.EntityFramework.Design</span><br></pre></td></tr></table></figure></p>
<p> 然后通过命令行<br> 执行<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet ef dbcontext Scaffold [ConnectionString] Microsoft.EntityFrameworkCore.SqlServer -o [Output Folder] -f</span><br></pre></td></tr></table></figure></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet ef dbcontext Scaffold &quot;Data Source=PV-1;Initial Catalog=e18060401;User ID=sa;Password=123456&quot; Microsoft.EntityFrameworkCore.SqlServer -o EntityFramework -f</span><br></pre></td></tr></table></figure>
<p> 手动替换链接字符串[ConnectionString]和输出文件夹[Output Folder]</p>
<p> -f 强制执行，当文件夹中存在对应的类的时候，执行会覆盖原文件</p>
<p> 详情见<a href="https://www.learnentityframeworkcore.com/walkthroughs/existing-database" target="_blank" rel="noopener">Generating a model from an existing database</a></p>
<h4 id="更简单的办法"><a href="#更简单的办法" class="headerlink" title="更简单的办法"></a>更简单的办法</h4><p> 当然是安装<a href="https://marketplace.visualstudio.com/items?itemName=ErikEJ.EFCorePowerTools" target="_blank" rel="noopener">EF Core Power Tools</a>啦</p>
<hr>
<h4 id="C-复制一个对象"><a href="#C-复制一个对象" class="headerlink" title="C# 复制一个对象"></a>C# 复制一个对象</h4><p> 详情见 <a href="https://github.com/Burtsev-Alexey/net-object-deep-copy/blob/master/ObjectExtensions.cs" target="_blank" rel="noopener">link</a></p>
<hr>
<h4 id="在asp-net-core-mvc-中使用vue-js-SPA"><a href="#在asp-net-core-mvc-中使用vue-js-SPA" class="headerlink" title="在asp.net core mvc 中使用vue.js SPA"></a>在asp.net core mvc 中使用vue.js SPA</h4><p> <a href="https://blog.csdn.net/u011822144/article/details/72764155" target="_blank" rel="noopener">.net core + vue开发单页应用</a></p>
<p> <a href="https://marczak.io/posts/netcore-vuejs/" target="_blank" rel="noopener">Building .NET Core 2.0 web apps with Vue.js single file components using VS Code</a></p>
<p> <a href="http://oopsguy.com/2017/11/14/vuejs-server-side-rendering-with-aspnet-core/" target="_blank" rel="noopener">ASP.NET Core 与 Vue.js 服务端渲染</a></p>
<p> <a href="https://github.com/taylorchen709/vue-admin" target="_blank" rel="noopener">vue.js + elementUI 管理后台 vue-admin</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Orches Adam</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/07/14/Miscellaneous/">http://yoursite.com/2019/07/14/Miscellaneous/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">Orches's Blog</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/07/14/DoNet-Interview/"><i class="fa fa-chevron-left">  </i><span>DotNet 工程师 面试问题</span></a></div><div class="next-post pull-right"><a href="/2018/04/02/C-Basic/"><span>C#_Basic</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By Orches Adam</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>